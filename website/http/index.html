<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Tron Suit 2.0</title>
    <link rel="stylesheet" type="text/css" href="tronstyle.css">
</head>
<body>
	<h2>Tron Suit 2.0 - CVG 2015</h2>
	Temp Navigation:
	<input type="button" value="MSG" onClick="document.getElementById('iframenav').src='messages.html'" />
    <input type="button" value="GPS" onClick="document.getElementById('iframenav').src='gps.html'" />
    <input type="button" value="CPU" onClick="document.getElementById('iframenav').src='cpu.html'" />
	<input type="button" value="YPR" onClick="document.getElementById('iframenav').src='ypr.html'" />
	<input type="button" value="STAT" onClick="document.getElementById('iframenav').src='stat.html'" />
    <br><br><div id="status_div">Buffering...</div>
    <br>
    <div id="points_div">Showing last suit colors...</div>
	<div class="gradient" id="current_gradient"></div>
    <br>
	<iframe id="iframenav" src="messages.html" width="100%" height="480" frameBorder="0"></iframe>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
</body>


<script>
	index_refresh_rate = 2000;
	index_datapoints = 8;
	index_last_timestamp = 0;
	index_buffering = 2;
	
	get_colors();    

	 function get_colors() {

        jQuery.get('index_get.php', null, function(tsv) {
            var tsv = tsv.split(/\n/g);

            var line = tsv[0].split(/\t/g);
            var timestamp = 1000 * Number(line[0]);

            var color1 = line[1];
            var color2 = line[2];

            if (color1 == "#000000" || color1 == "#000000") {
                $("#current_gradient").css({
                    'background': 'linear-gradient(to right, rgba(255,0,0,0),rgba(255,0,0,0))'
                });
            } else {
                $("#current_gradient").css({
                    'background': 'linear-gradient(to right, ' + color1 + ' 0%, ' + color2 + ' 100%)'
                });
            }

	        if (index_last_timestamp < timestamp && index_last_timestamp != 0) {
                document.getElementById("status_div").innerHTML = "Suit is Online.";
                document.getElementById("points_div").innerHTML = "Showing live suit colors:";
                index_buffering = 0;
            } else {
                if (index_buffering < index_datapoints) {
                    index_buffering++;
                    if (index_buffering > 2) {  //give a little leeway for missed uploads
                        document.getElementById("status_div").innerHTML = "Suit Buffering...";
                        document.getElementById("points_div").innerHTML = "Showing live suit colors:";
                    }
                } else {
                    document.getElementById("status_div").innerHTML = "Suit is Offline.";
                    document.getElementById("points_div").innerHTML = "Showing last suit colors:";
                }
            }
			index_last_timestamp = timestamp;
        });
        setTimeout(get_colors, index_refresh_rate);
    }
</script>
<script>
    //Google Analytics Stuff
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-61757882-1', 'auto');
    ga('send', 'pageview');
</script>